<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Design Book Asset Generator</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- D3.js -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/main.css">
    
    <style>
        body {
            background-color: #e2e8f0;
            padding: 40px;
            overflow: auto; /* Enable standard scrolling for this tool */
        }

        /* A4 Page Simulation */
        .a4-page {
            background: white;
            width: 210mm;
            min-height: 297mm;
            margin: 0 auto 40px;
            padding: 20mm; /* Standard margins */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            box-sizing: border-box;
            position: relative;
        }

        /* Chart Container for Screenshots */
        .export-container {
            border: 1px dashed #cbd5e1;
            margin-bottom: 40px;
            position: relative;
        }

        .export-label {
            position: absolute;
            top: -25px;
            left: 0;
            font-family: monospace;
            font-size: 12px;
            color: #64748b;
        }

        /* Aspect Ratio Utilities */
        .ratio-16-9 { aspect-ratio: 16/9; }
        .ratio-2-1 { aspect-ratio: 2/1; }
        .ratio-square { aspect-ratio: 1/1; }
        
        /* Force charts to fit */
        .chart { width: 100%; height: 100%; }
        
        h1 { text-align: center; margin-bottom: 40px; color: #334155; }
        
        /* Override app styles that might interfere */
        main { display: block !important; width: auto !important; height: auto !important; overflow: visible !important; }
        .chart-loading { display: none; }
    </style>
</head>
<body>

    <h1>Design Book Asset Generator (A4 Optimised)</h1>

    <!-- Page 1: Key Trends -->
    <div class="a4-page">
        <h2>Temporal Analysis</h2>
        <p>Use Chrome DevTools: Right-click node -> Capture node screenshot</p>
        
        <div class="export-container ratio-2-1">
            <span class="export-label">trend_static.png (Half Page Width)</span>
            <div id="trend-chart" class="chart"></div>
        </div>

        <div class="export-container ratio-2-1">
            <span class="export-label">slope-chart.png (Half Page Width)</span>
            <div id="slope-chart" class="chart"></div>
        </div>
    </div>

    <!-- Page 2: Geography -->
    <div class="a4-page">
        <h2>Geographic Distribution</h2>
        
        <div class="export-container ratio-16-9">
            <span class="export-label">map_chart.png (Full Width)</span>
            <div id="map-chart" class="chart chart-map"></div>
        </div>
        
        <div class="export-container ratio-2-1" style="margin-top: 20px;">
            <span class="export-label">jurisdiction_bar.png</span>
            <div id="jurisdiction-chart" class="chart"></div>
        </div>
    </div>

    <!-- Page 3: Deep Dive -->
    <div class="a4-page">
        <h2>Substance Analysis</h2>
        
        <div class="export-container ratio-2-1">
            <span class="export-label">stacked_bar.png</span>
            <div id="stacked-chart" class="chart"></div>
        </div>

        <div class="export-container ratio-2-1" style="margin-top: 20px;">
            <span class="export-label">heatmap.png</span>
            <div id="heatmap-chart" class="chart chart-heatmap"></div>
        </div>
    </div>

    <!-- Tooltip container (required for charts to init) -->
    <div id="tooltip" class="tooltip"></div>

    <script type="module">
        import { App } from './js/app.js';
        
        // Override the App class to skip UI interactions that don't make sense here
        class ExportApp extends App {
            setupNavigation() {} // Disable scroll hijacking
            setupHorizontalScroll() {} // Disable horizontal scroll
            setupScrollAnimations() {} // Disable animations
            
            async init() {
                await this.loadData();
                this.tooltip = { show: () => {}, hide: () => {}, move: () => {} }; // Mock tooltip
                
                // Initialize charts with static settings
                this.filterController = {
                    getFilters: () => ({
                        yearStart: 2008,
                        yearEnd: 2024,
                        jurisdiction: 'all',
                        drugTypes: ['Amphetamine', 'Cannabis', 'Ecstasy', 'Cocaine']
                    })
                };

                this.initCharts();
                console.log('âœ… Export charts rendered');
            }
        }

        const app = new ExportApp();
        app.init();
    </script>
</body>
</html>
